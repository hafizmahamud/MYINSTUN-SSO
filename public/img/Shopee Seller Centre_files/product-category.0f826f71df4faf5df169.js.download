(window.webpackJsonpSellerCenterProduct=window.webpackJsonpSellerCenterProduct||[]).push([[5],{Of3f:function(t,e,r){"use strict";r.r(e);var o=r("za2R"),a=r("qOf3");for(var n in a)"default"!==n&&function(t){r.d(e,t,function(){return a[t]})}(n);r("aN8O");var i=r("+qdZ"),s=Object(i.a)(a.default,o.a,o.b,!1,null,"4046e002",null);e.default=s.exports},RgPI:function(t,e,r){"use strict";var o=r("/vmb");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r("9BU/");var a=o(r("CUhp"));r("0SKM");var n=o(r("tkun")),i=o(r("jaXf")),s=o(r("5nO9")),c=r("74oa"),u=o(r("jLS7")),d=o(r("s3G2")),p=o(r("nfno")),m=o(r("qrWI")),l=o(r("y2rW")),g=o(r("PtPb")),f=r("Aaa2"),h=r("/1eF"),y=r("jxKE"),C=r("QhvS"),v=r("0lfv"),_=r("R/S1"),R=r("Nhdc"),P=r("re4G"),T=r("DvX/"),E=r("YCKj"),D=r("r4pR"),k=r("M2Qi"),b=r("9Yr+"),w=r("Vh8D"),M=function(t,e,r,o){var a,n=arguments.length,i=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"===("undefined"==typeof Reflect?"undefined":(0,g.default)(Reflect))&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(i=(n<3?a(i):n>3?a(e,r,i):a(e,r))||i);return n>3&&i&&Object.defineProperty(e,r,i),i},S=function(t,e,r,o){return new(r||(r=Promise))(function(a,n){function i(t){try{c(o.next(t))}catch(t){n(t)}}function s(t){try{c(o.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})},A=(0,b.namespace)("product"),O=(0,b.namespace)("product/category"),I=(0,b.namespace)("product/detail"),N=function(t){function e(){var t;return(0,u.default)(this,e),(t=(0,p.default)(this,(0,m.default)(e).apply(this,arguments))).showCategoryRecommend=!1,t.recommendCategoryTree=[],t.initCategoryPath=[],t.fromPage="",t.productId="",t.isCatsInvalid=!1,t.getCategoryRecommnendLoading=!1,t}return(0,l.default)(e,t),(0,d.default)(e,[{key:"getRcommendDeeperCategories",value:function(){return S(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=[],this.catsRecommends.forEach(function(t){t.length>c.CategoryService.Constants.CATEGORY_DEFAULT_FETCHED_LEVEL+1&&e.push(t[c.CategoryService.Constants.CATEGORY_DEFAULT_FETCHED_LEVEL])}),!e.length){t.next=5;break}return t.next=5,this.getDeeperCategoryTree({categoryIds:e,fetchDepth:c.CategoryService.Constants.CATEGORY_MAX_LEVEL-c.CategoryService.Constants.CATEGORY_DEFAULT_FETCHED_LEVEL});case 5:this.recommendCategoryTree=this.catsRecommends.map(function(t){return E.categoryService.categoryQuickFind(r.categoryTree,t)}).filter(function(t){return!!t.length});case 6:case"end":return t.stop()}},t,this)}))}},{key:"handleCategoryRecommend",value:function(){var t=this;this.bufferName&&(this.showCategoryRecommend=!0,this.getCategoryRecommnendLoading=!0,(this.$features.support("szEnableCatRecommendPhase2")||this.isWrongCategoryInPhase1)&&(this.bufferData.nameError?(this.setCategoryRecommend({dsCatRcmdId:0,catsRecommend:[]}),this.getCategoryRecommnendLoading=!1):this.$features.support("szEnableCatRecommendPhase2")?this.getCategoryRecommend(this.bufferName).then(function(e){e&&e.catsRecommend&&e.catsRecommend.length&&(t.getCategoryRecommnendLoading=!1)}):(this.setCategoryRecommend({dsCatRcmdId:0,catsRecommend:[]}),this.getCategoryRecommnendLoading=!1)))}},{key:"setSelectedCategory",value:function(t){this.initCategoryPath=(0,s.default)(t),this.showCategoryRecommend=!1,D.productDetailTrackerModule.triggerClickSellerCenterNewProductCategoryCategoryRecommendationOption()}},{key:"onSearchInput",value:function(){D.productDetailTrackerModule.triggerActionSearchInCategory()}},{key:"updateBufferCategoryAndValid",value:function(t){var e=t.invalid,r=t.value;this.isCatsInvalid=e,this.updateProductBufferData({categoryPath:(0,s.default)(r)})}},{key:"goToEditPage",value:function(){return S(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e="unpublished-product-edit"===this.fromPage?{itemid:this.productId,itemStatus:y.PRODUCT_STATUS.ITEM_UNPUBLISHED}:"product-edit"===this.fromPage?{itemid:this.productId,itemStatus:this.product.status}:null,D.productDetailTrackerModule.triggerClickProductNewNextButton(e),this.validateName(),this.bufferData.nameError||("unpublished-product-edit"===this.fromPage?this.secureDiscardTransition("/portal/product/unpublished/".concat(this.productId)):"mtsku-product-edit"===this.fromPage?this.secureDiscardTransition("/portal/product/mtsku/".concat(this.productId)):"mtsku-product-new"===this.fromPage?this.secureDiscardTransition("/portal/product/mtsku/new"):"product-edit"===this.fromPage?(r=this.$route.query[y.MPSKU_FROM_PAGE_PARAMS]?(0,i.default)({},y.MPSKU_FROM_PAGE_PARAMS,this.$route.query[y.MPSKU_FROM_PAGE_PARAMS]):{},this.secureDiscardTransition({path:"/portal/product/".concat(this.productId),query:r})):"product-new"===this.fromPage?this.secureDiscardTransition("/portal/product/new"):this.isMtskuPage?this.secureDiscardTransition("/portal/product/mtsku/new"):this.secureDiscardTransition("/portal/product/new"));case 4:case"end":return t.stop()}},t,this)}))}},{key:"validateName",value:function(){if(this.isMtskuPage){var t=(0,v.validateMtskuProductName)(this.bufferName,this.productConstraints);this.updateProductBufferData({nameError:t})}else{var e=(0,v.validateProductName)(this.bufferName,this.productConstraints);this.updateProductBufferData({nameError:e})}}},{key:"created",value:function(){var t=this;(0,_.openAchCheck)("portalProductList").catch(function(){t.secureDiscardTransition("/portal/product/list/all")}),D.productDetailTrackerModule.triggerViewProductCategory(),D.productDetailTrackerModule.triggerImpressionProductNewNameRemind(),this.getCategoryRecommendDebounce=h.App.Utility.debounce(this.handleCategoryRecommend,1e3,this),!h.app.environment.isCBSC||this.isMtskuPage||this.product.id||this.secureDiscardTransition("/portal/product/list")}},{key:"mounted",value:function(){var t=this;this.$nextTick(function(){k.productCategoryReporter.setCustomPointTime(k.POINT_CATEGORY_FIRST_RENDER),k.productCategoryReporter.report();var e=t.fromPage;["product-new","product-edit","mtsku-product-new","mtsku-product-edit","unpublished-product-edit"].includes(e)&&(t.updateProductBufferData({name:t.product.name,categoryPath:(0,s.default)(t.product.categoryPath)}),t.initCategoryPath=(0,s.default)(t.product.categoryPath),t.$set(t.discardCheckModels,0,t.bufferData))})}},{key:"onPopupDiscardConfirm",value:function(t){["product-new","product-edit","mtsku-product-new","mtsku-product-edit","unpublished-product-edit"].includes(t.name)&&this.updateProductBufferData({name:this.product.name,nameError:!1,categoryPath:this.product.categoryPath})}},{key:"beforeRouteLeave",value:function(t,e,r){["product-new","product-edit","mtsku-product-new","mtsku-product-edit","unpublished-product-edit"].includes(t.name)||this.cleanProductBufferData(),r()}},{key:"beforeRouteEnter",value:function(t,e,r){var o=e.name;r(function(t){t.fromPage=o,["product-edit","mtsku-product-edit","unpublished-product-edit"].includes(o)&&(t.productId=e.params.id)})}},{key:"bufferNameLen",get:function(){return(0,v.strLength)(this.bufferName)}},{key:"bufferName",get:function(){return this.bufferData.name},set:function(t){this.updateProductBufferData({name:t}),this.validateName()}},{key:"recommendCategoriesDisplay",get:function(){var t=[];return this.recommendCategoryTree.forEach(function(e){var r=[];e.some(function(e){return r.push(e),!e.hasActiveChildren&&(t.push(r),!0)})}),t}},{key:"selectedRecommendIndex",get:function(){return this.catsRecommends.map(function(t){return t.join(" ")}).indexOf(this.initCategoryPath&&this.initCategoryPath.join(" "))}},{key:"isWrongCategoryInPhase1",get:function(){return this.product.computedStatusPriority&&"wrongCategory"===this.product.computedStatusPriority.status}},{key:"saveButtonDisabled",get:function(){return this.isCatsInvalid||!this.bufferData.categoryPath.length}},{key:"isMtskuPage",get:function(){return(0,v.isMtskuPage)()}}]),e}((0,f.Mixins)(C.DiscardChangeMixin));M([A.listingState("productConstraints")],N.prototype,"productConstraints",void 0),M([O.listingState("productCatsRecommend")],N.prototype,"catsRecommends",void 0),M([O.listingGetter("productCategoryTree")],N.prototype,"categoryTree",void 0),M([A.listingAction(P.GET_PRODUCT_CATEGORY_TREE)],N.prototype,"getCategoryTree",void 0),M([O.listingAction(T.GET_PRODUCT_DEEPER_CATEGORY_TREE)],N.prototype,"getDeeperCategoryTree",void 0),M([O.listingAction(P.GET_PRODUCT_CATEGORY_RECOMMEND)],N.prototype,"getCategoryRecommend",void 0),M([O.listingAction(P.SET_PRODUCT_CATEGORY_RECOMMEND)],N.prototype,"setCategoryRecommend",void 0),M([I.listingState("product")],N.prototype,"product",void 0),M([I.State("bufferData")],N.prototype,"bufferData",void 0),M([I.Mutation(w.MUTATION_SET_PRODUCT_BUFFER_DATA)],N.prototype,"updateProductBufferData",void 0),M([I.Mutation(w.MUTATION_CLEAN_PRODUCT_BUFFER_DATA)],N.prototype,"cleanProductBufferData",void 0),M([(0,f.Watch)("catsRecommends")],N.prototype,"getRcommendDeeperCategories",null);var x=N=M([(0,f.Component)({components:{ProductEditInput:R.ProductEditInput,ShopeeCategorySelector:n.default.Selector,ShopeeFormItemTopError:a.default}})],N);e.default=x},aN8O:function(t,e,r){"use strict";var o=r("x82g");r.n(o).a},"m/uF":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M526 1394q0 53-37.5 90.5T398 1522q-52 0-90-38t-38-90q0-53 37.5-90.5T398 1266t90.5 37.5T526 1394zm498 206q0 53-37.5 90.5T896 1728t-90.5-37.5T768 1600t37.5-90.5T896 1472t90.5 37.5 37.5 90.5zM320 896q0 53-37.5 90.5T192 1024t-90.5-37.5T64 896t37.5-90.5T192 768t90.5 37.5T320 896zm1202 498q0 52-38 90t-90 38q-53 0-90.5-37.5T1266 1394t37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM558 398q0 66-47 113t-113 47-113-47-47-113 47-113 113-47 113 47 47 113zm1170 498q0 53-37.5 90.5T1600 1024t-90.5-37.5T1472 896t37.5-90.5T1600 768t90.5 37.5T1728 896zm-640-704q0 80-56 136t-136 56-136-56-56-136 56-136T896 0t136 56 56 136zm530 206q0 93-66 158.5T1394 622q-93 0-158.5-65.5T1170 398q0-92 65.5-158t158.5-66q92 0 158 66t66 158z"></path></svg>'},qOf3:function(t,e,r){"use strict";r.r(e);var o=r("RgPI"),a=r.n(o);for(var n in o)"default"!==n&&function(t){r.d(e,t,function(){return o[t]})}(n);e.default=a.a},x82g:function(t,e,r){},za2R:function(t,e,r){"use strict";var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"product-category"},[o("div",{staticClass:"old-wrapper content"},[o("div",{staticClass:"header"},[o("h2",{staticClass:"title"},[t._v("\n        "+t._s(t.$t("ps_add_new_product"))+"\n      ")]),t._v(" "),o("p",{staticClass:"desc"},[t._v("\n        "+t._s(t.$t("ps_add_new_product_desc"))+"\n      ")])]),t._v(" "),o("div",{staticClass:"product-name-edit",on:{mouseleave:function(e){t.showCategoryRecommend=!1}}},[o("label",{staticClass:"label-product"},[t._v(t._s(t.$t("label_preview_product_name"))+":")]),t._v(" "),o("div",{staticClass:"input-wrap"},[o("product-edit-input",{attrs:{"unicode-normalized":"",size:"large",maxlength:t.productConstraints.titleLengthMax,minlength:t.productConstraints.titleLengthMin,"suffix-label":t.bufferNameLen+"/"+t.productConstraints.titleLengthMax,"error-message":t.bufferData.nameError},on:{focus:function(e){t.showCategoryRecommend=!0},input:t.getCategoryRecommendDebounce},model:{value:t.bufferName,callback:function(e){t.bufferName=e},expression:"bufferName"}}),t._v(" "),t.recommendCategoriesDisplay.length>0&&t.showCategoryRecommend?o("div",{class:{"cats-recommends":!0,loading:t.getCategoryRecommnendLoading}},[o("h3",[t._v(t._s(t.$t("ps_recommend_categories")))]),t._v(" "),t._l(t.recommendCategoriesDisplay,function(e,a){return[o("div",{key:e.id,class:["cats-item",{selected:a===t.selectedRecommendIndex}],on:{click:function(e){return t.setSelectedCategory(t.catsRecommends[a])}}},[t._v("\n              "+t._s(a+1+"、")+"\n              "),t._l(e,function(a,n){return o("span",{key:a.id,staticClass:"shopee-category__main__recommend__title"},[t._v("\n                "+t._s(a.showName)+"\n                "),o("shopee-icon",{directives:[{name:"show",rawName:"v-show",value:n<e.length-1,expression:"index2 < recommend.length - 1"}],attrs:{svg:r("goGE")}})],1)})],2)]}),t._v(" "),t.getCategoryRecommnendLoading?o("div",{staticClass:"position-centered"},[o("shopee-icon",{attrs:{spin:"",svg:r("m/uF")}})],1):t._e()],2):t._e()],1)]),t._v(" "),o("shopee-category-selector",{staticClass:"category-selector",attrs:{"category-tree":t.categoryTree,"is-wrong-category-in-phase1":t.isWrongCategoryInPhase1,"fetch-sub-category":t.getDeeperCategoryTree,"is-mtsku-category":t.isMtskuPage},on:{change:t.updateBufferCategoryAndValid,"search-input-change":t.onSearchInput},model:{value:t.initCategoryPath,callback:function(e){t.initCategoryPath=e},expression:"initCategoryPath"}}),t._v(" "),o("shopee-button",{staticStyle:{width:"115px"},attrs:{size:"large",type:"primary",disabled:t.saveButtonDisabled},on:{click:t.goToEditPage}},[t._v("\n      "+t._s(t.$t("label_next"))+"\n    ")])],1)])},a=[];r.d(e,"a",function(){return o}),r.d(e,"b",function(){return a})}}]);